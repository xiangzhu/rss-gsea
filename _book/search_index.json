[
["index.html", "Integrated Enrichment Analysis of Genetic Variants and Biological Pathways using GWAS Summary Data 1 Basic Information", " Integrated Enrichment Analysis of Genetic Variants and Biological Pathways using GWAS Summary Data Xiang Zhu 2016-11-13 1 Basic Information Who Xiang Zhu is a graduate student in the Department of Statistics at the University of Chicago, and his dissertation advisor is Prof. Matthew Stephens. What This is my notebook for a research project, the aim of which is to develop statistical methods for integrated enrichment analysis of genome-wide association studies (GWAS) summary data and biological pathways. Specifically, I combine the likelihood function from Zhu and Stephens (2016) with the prior distribution from Carbonetto and Stephens (2013), and then perform Bayesian analysis. How I make this notebook using many wonderful publicly available tools, including rmarkdown, knitr, bookdown, pandoc and plotly. This notebook is largely motivated by the idea from the singleCellseq project at the Gilad Lab. To host the notebook, I use GitHub Pages. Contact If you have any question about this notebook, please feel free to contact me. Create a new issue in GitHub. Send an email to xiangzhu@uchicago.edu. References "],
["license-cite.html", "1.1 License &amp; Cite", " 1.1 License &amp; Cite Currently the notebook is licensed under the Creative Commons Attribution-NoDerivatives 4.0 International License (CC BY-ND 4.0). This means you are free to include content from this site in your presentation, blog, or social media posts, as long you cite it. The “no derivatives” clause means you cannot modify the results and distribute them. Once the results are published (manuscript in preparation), I will remove “no derivatives” clause. The source code in the notebook is licensed under the GNU General Public License, version 3.0 (GPLv3). If you use any results from this notebook, please cite it by including the following text: Zhu, X. (2016). Integrated Enrichment Analysis of Genetic Variants and Biological Pathways using GWAS Summary Data. Stephens Laboratory Notebook at the University of Chicago. Retrieved from https://github.com/xiangzhu/rss-gsea "],
["news.html", "1.2 News", " 1.2 News 10/20/2016: Xiang presented this work at the 2016 American Society of Human Genetics Annual Meeting (ASHG2016), Vancouver, BC, Canada. [Poster] 03/04/2016: Xiang presented this work at the 2016 Novembre-He-Stephens meeting, Chicago. IL. [Slides] 10/15/2015: Xiang presented this work at the 2015 Probabilistic Modeling in Genomics Conference (ProbGen15), Cold Spring Harbor Laboratory, NY. [Poster] -->"],
["method-overview.html", "2 Method Overview", " 2 Method Overview Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 "],
["statistical-models.html", "2.1 Statistical Models", " 2.1 Statistical Models "],
["software.html", "2.2 Software", " 2.2 Software -->"],
["data-overview.html", "3 Data Overview", " 3 Data Overview Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 Four types of data are used in our analysis. GWAS summary statistics Phased haplotype database Gene database Pathway database "],
["height-2014.html", "4 Height 2014", " 4 Height 2014 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The following analyses have been performed on Height 2014 dataset. Pilot Analysis (Section 4.1) GSEA Round 1 (Section 4.2) "],
["height2014-1.html", "4.1 Pilot Analysis", " 4.1 Pilot Analysis Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 4.1.1 Fit the null model 4.1.2 Fit the enrichment model 4.1.2.1 Example 1: Top enrichments Tabulate the top six enriched pathways for height. id bf name source database numgene numsnps theta.mean theta.sd theta0.mean theta0.sd 3208 3.278166e+64 Endochondral Ossification wiki BioSystems 65 7573 0.7500000 0.0000008 -2 0 3859 1.494140e+47 Cellular responses to stress reactome PC 258 16444 0.5000000 0.0000022 -2 0 3856 7.837627e+44 Metabolism of RNA reactome PC 257 17586 0.5000000 0.0000000 -2 0 3725 5.458711e+44 TGF-beta Receptor Signaling Pathway wiki BioSystems 149 13241 0.5059478 0.0380995 -2 0 3783 1.223700e+44 Cellular Senescence reactome PC 183 10005 0.7471961 0.0263271 -2 0 3839 7.048442e+42 Chromatin modifying enzymes reactome BioSystems 241 15037 0.5000000 0.0000077 -2 0 Plot the gene sharing pattern among these six top pathways. Figure 4.1: Gene sharing of the top enriched pathways 4.1.2.2 Example 2: Hedgehog signaling pathway Retrieve all the pathways whose names contain the word “Hedgehog”. Tabulate the ones with the largest BFs. id bf name source database numgene numsnps theta.mean theta.sd theta0.mean theta0.sd 3398 3.406931e+34 Hedgehog ‘on’ state reactome BioSystems 83 6283 0.7497261 0.0082701 -2 0 3677 1.914504e+32 Signaling by Hedgehog reactome BioSystems 132 11887 0.5000000 0.0000100 -2 0 2978 3.984276e+30 Hedgehog signaling pathway kegg BioSystems 50 4377 0.7499489 0.0035759 -2 0 2067 6.256309e+23 Signaling events mediated by the Hedgehog family pid PC 23 2495 0.7540134 0.0314299 -2 0 2045 4.661006e+23 Signaling events mediated by the Hedgehog family pid BioSystems 22 2490 0.7532245 0.0282210 -2 0 3598 2.061373e+22 Signaling by Hedgehog reactome PC 110 9840 0.5000000 0.0000175 -2 0 Plot the gene sharing pattern. Figure 4.2: Gene sharing of Hedgehog pathways 4.1.2.3 Example 3: GTEx tissue specific eQTL Figure 4.3: Enrichment of height associations in GTEx tissues 4.1.3 Prioritize variants in the enriched pathway eo.data &lt;- R.matlab::readMat(&quot;~/Dropbox/rss/Data/height_2014/pathway/jobscripts_201601/height2014_eo_201602.mat&quot;) eo.df &lt;- data.frame( seg.chr &lt;- c(eo.data$segchr), seg.start &lt;- c(eo.data$segpos), p1.null &lt;- c(eo.data$P1null), p2.null &lt;- c(eo.data$P2null), p1.gsea &lt;- c(eo.data$P1), p2.gsea &lt;- c(eo.data$P2) ) names(eo.df) &lt;- c(&quot;seg.chr&quot;,&quot;seg.start&quot;,&quot;p1.null&quot;,&quot;p2.null&quot;,&quot;p1.gsea&quot;,&quot;p2.gsea&quot;) snp.df &lt;- data.frame( chr &lt;- c(eo.data$chr), pos &lt;- c(eo.data$pos) ) names(snp.df) &lt;- c(&quot;chr&quot;,&quot;pos&quot;) Find the start and end of each chromosome. chr.start = chr.end = NULL for (i in 1:22) { snp.df.chr &lt;- snp.df[snp.df$chr == i, ] chr.start[i] &lt;- min(snp.df.chr$pos) chr.end[i] &lt;- max(snp.df.chr$pos) } Find the end of each 50-SNP segment. num.seg &lt;- dim(eo.df)[1] seg.end &lt;- NULL for (i in 1:(num.seg-2)) { chr.id &lt;- eo.df$seg.chr[i] if (eo.df$seg.chr[i+2] &gt; chr.id) { seg.end[i] &lt;- chr.end[chr.id] } else { seg.end[i] &lt;- eo.df$seg.start[i+2] } } seg.end[num.seg-1] &lt;- chr.end[22] seg.end[num.seg] &lt;- chr.end[22] eo.df$seg.end &lt;- seg.end eo.df &lt;- eo.df[c(1:2,7,3:6)] Load the GWAS hits reported in Wood et al (2014). cojo.results &lt;- read.table(&quot;~/Dropbox/rss/Data/height_2014/height2014.cojo.txt&quot;, header=TRUE) # Note that the published GWAS hits were based on a different assembly (NCBI build 36 / hg18). # See height_2014_40kb.Rmd for a detail description. cojo.mart.hg19 &lt;- as.character(unlist(read.table(&quot;~/Dropbox/rss/Data/height_2014/cojo.mart.hg19.bed&quot;, header=FALSE))) cojo.mart.hg19.tmp &lt;- matrix(unlist(strsplit(cojo.mart.hg19, &quot;-&quot;)), ncol=2, byrow=TRUE) cojo.mart.hg19.pos &lt;- as.numeric(cojo.mart.hg19.tmp[, 2]) cojo.results$pos19 &lt;- cojo.mart.hg19.pos Find the nearest GWAS hits and the absolute distance for each segment (unit: bp). distance &lt;- NULL nearhits &lt;- NULL for (j in 1:num.seg) { # specify the chromosome and region chr &lt;- eo.df$seg.chr[j] start &lt;- eo.df$seg.start[j] end &lt;- eo.df$seg.end[j] # find the GWAS hits on the chromosome chr.index &lt;- which(cojo.results$chr == chr) # find the GWAS hits inside the region ins.index &lt;- which(cojo.results$chr == chr &amp; cojo.results$pos19 &gt;= start &amp; cojo.results$pos19 &lt;= end) hit.ins &lt;- cojo.results[ins.index, ] if (dim(hit.ins)[1]&gt;0) { # distance b/t hit and region is zero if hit is inside the region distance[j] &lt;- 0 nearhits[j] &lt;- paste0(as.character(hit.ins$snp), collapse=&quot;-&quot;) } else { # find the GWAS hits outside the region out.index &lt;- setdiff(chr.index, ins.index) hit.out &lt;- cojo.results[out.index, ] # compute the distance b/t each hit and the region start.absdiff &lt;- abs(hit.out$pos19 - start) end.absdiff &lt;- abs(hit.out$pos19 - end) # find the GWAS hits with smallest absolute distance start.min.index &lt;- which.min(start.absdiff) end.min.index &lt;- which.min(end.absdiff) # compare up and down stream distances if (start.absdiff[start.min.index] &lt;= end.absdiff[end.min.index]) { distance[j] &lt;- start.absdiff[start.min.index] nearhits[j] &lt;- as.character(hit.out$snp[start.min.index]) } else { distance[j] &lt;- end.absdiff[end.min.index] nearhits[j] &lt;- as.character(hit.out$snp[end.min.index]) } } } eo.df$hit.distance &lt;- distance eo.df$nearest.hit &lt;- nearhits eo.df.all &lt;- eo.df rm(eo.df) eo.df &lt;- eo.df.all[(eo.df.all$p1.gsea&gt;eo.df.all$p1.null) &amp; (eo.df.all$p1.gsea&gt;=0.5), ] Find and annotate closest genes to genomic regions. # minor re-format the data frame eo.df for the makeGRangesFromDataFrame function names(eo.df)[1:3] &lt;- c(&quot;chr&quot;,&quot;start&quot;,&quot;end&quot;) eo.df$chr &lt;- paste0(&quot;chr&quot;,eo.df$chr) # create a GRanges for the safe.df eo.df.GRanges &lt;- GenomicRanges::makeGRangesFromDataFrame(eo.df) # prepare a GRanges for the matchGenes function genes &lt;- bumphunter::annotateTranscripts(TxDb.Hsapiens.UCSC.hg19.knownGene,annotation=&quot;org.Hs.eg.db&quot;) # find and annotate the closest genes to the regions eo.df.annotation &lt;- bumphunter::matchGenes(eo.df.GRanges, genes) # NB: this step may take some time ## .............................. # add annotations to the data frame eo.df$nearest.gene &lt;- eo.df.annotation$name eo.df$description &lt;- eo.df.annotation$description eo.df$entrez.id &lt;- eo.df.annotation$Entrez Check whether the enrichment of Endochondral Ossification pathway informs additional associations. index &lt;- (eo.df$p1.gsea&gt;eo.df$p1.null) &amp; (eo.df$p1.gsea&gt;=0.5) &amp; (eo.df$hit.distance&gt;1e6) eo.df.gsea &lt;- eo.df[index, ] # compute the difference of P1 between null and gsea eo.df.gsea$p1.diff &lt;- eo.df.gsea$p1.gsea - eo.df.gsea$p1.null # sort the data frame head(plyr::arrange(eo.df.gsea, -p1.diff, p1.gsea, hit.distance)) ## chr start end p1.null p2.null p1.gsea p2.gsea ## 1 chr10 75594486 75773362 0.3390032 0.06356617 0.9999990 0.9988306 ## 2 chr3 46903094 47129903 0.4081798 0.09309055 1.0000000 0.9987614 ## 3 chr12 48411158 48502574 0.2478482 0.03271621 0.8084977 0.4791943 ## 4 chr3 46982737 47292183 0.4535651 0.11808550 0.9999951 0.5491097 ## 5 chr10 75663736 75867193 0.4572957 0.11685930 0.9999988 0.9985150 ## 6 chr10 88410041 88520409 0.4208622 0.10110958 0.9598333 0.7656805 ## hit.distance nearest.hit nearest.gene description entrez.id p1.diff ## 1 5155431 rs1815314 CAMK2G overlaps 5&#39; 818 0.6609959 ## 2 3941810 rs13088462 PTH1R covers 5745 0.5918202 ## 3 1584135 rs10880969 PFKM overlaps 5&#39; 5213 0.5606495 ## 4 3779530 rs13088462 KIF9 overlaps 3&#39; 64147 0.5464299 ## 5 5061600 rs1815314 VCL overlaps 5&#39; 7414 0.5427031 ## 6 4517000 rs2631676 OPN4 covers 94233 0.5389711 Check whether the findings are novel. intersect(as.character(cojo.results$nearest.gene), &quot;CAMK2G&quot;) ## character(0) intersect(as.character(cojo.results$nearest.gene), &quot;PTH1R&quot;) ## character(0) Visualize the association results informed by the enrichment. Validate the findings via literature review. CAMK2G skeletal muscle function during exercise: https://www.ncbi.nlm.nih.gov/pubmed/16690701 PTH1R bone formation: http://www.ncbi.nlm.nih.gov/pubmed/20929987 osteocyte survival: http://www.ncbi.nlm.nih.gov/pubmed/25529820 "],
["height2014-2.html", "4.2 GSEA Round 1", " 4.2 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 4.2.1 Fit the null model I used the grids theta0 = (-4:0.25:-1)' and h = (0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the setting (h=0.3, theta0=-2). 4.2.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-2), since the null analysis suggests that almost 100% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta = (0:0.01:2)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 4.3), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.2932 Min. :0.2700 Min. :0.3200 ## 1st Qu.:0.4343 1st Qu.:0.3775 1st Qu.:0.4900 ## Median :0.4835 Median :0.4400 Median :0.5200 ## Mean :0.4993 Mean :0.4440 Mean :0.5500 ## 3rd Qu.:0.5656 3rd Qu.:0.5000 3rd Qu.:0.6225 ## Max. :0.7517 Max. :0.6900 Max. :0.8200 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 22.0 Min. : 1800 ## 1st Qu.:142.8 1st Qu.:11789 ## Median :253.0 Median :19783 ## Mean :239.2 Mean :21029 ## 3rd Qu.:312.2 3rd Qu.:30170 ## Max. :496.0 Max. :58142 4.2.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["height2014-3.html", "4.3 GSEA Round 2", " 4.3 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 4.3.1 Fit the null model From the Round 1 null analysis (Section 4.2), I found that almost 100% posterior mass is concentrated on the setting (h=0.3, theta0=-2). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-2.25:0.025:-1.75)' and h=(0.3:0.1:0.4)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 42 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.3 and theta0=(-2.075:0.025:-1.925)'. h.index &lt;- as.character(null.df$h) %in% as.character(0.3) theta0.index &lt;- as.character(null.df$theta0[h.index]) %in% as.character(seq(-2.075,-1.925,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 1 4.3.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-2.075:0.025:-1.925)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:0.01:1)'. The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["schizophrenia-2014.html", "5 Schizophrenia 2014", " 5 Schizophrenia 2014 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Schizophrenia Working Group of the Psychiatric Genomics Consortium (2014) are provided by the Psychiatric Genomics Consortium (PGC). The basic information about these datasets is available here. The following analyses have been performed on Schizophrenia (SCZ) 2014 dataset. GSEA Round 1 (Section 5.1) GSEA Round 2 (Section 5.2) References "],
["scz2014-1.html", "5.1 GSEA Round 1", " 5.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 5.1.1 Fit the null model I used the grids theta0=(-4:0.25:-1)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.4% posterior mass is concentrated on the setting (h=0.3, theta0=-2). 5.1.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-2), since the null analysis suggests that almost 99.4% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta = (0:0.01:2)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 5.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.08307 Min. :0.0000 Min. :0.1600 ## 1st Qu.:0.23276 1st Qu.:0.0475 1st Qu.:0.4150 ## Median :0.30912 Median :0.0650 Median :0.4900 ## Mean :0.34837 Mean :0.0850 Mean :0.5701 ## 3rd Qu.:0.45745 3rd Qu.:0.1025 3rd Qu.:0.7225 ## Max. :1.35323 Max. :0.8700 Max. :1.6300 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 96.0 ## 1st Qu.: 9.50 1st Qu.: 677.2 ## Median : 37.50 Median : 1806.5 ## Mean : 62.45 Mean : 4603.3 ## 3rd Qu.: 68.50 3rd Qu.: 4357.8 ## Max. :316.00 Max. :28002.0 5.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["scz2014-2.html", "5.2 GSEA Round 2", " 5.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 5.2.1 Fit the null model From the Round 1 null analysis (Section 5.1), I found that almost 99.4% posterior mass is concentrated on the setting (h=0.3, theta0=-2). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-2.25:0.025:-1.75)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.3 and theta0=(-2.2:0.025:-2.05)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-2.2,-2.05,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999824 5.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-2.2:0.025:-2.05)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:0.01:2)', based on the Round 1 enrichment analysis (Section 5.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["bmi2015.html", "6 Body Mass Index 2015", " 6 Body Mass Index 2015 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Locke et al. (2015) are provided by the Genetic Investigation of ANthropometric Traits (GIANT) consortium. Below is the basic information about these datasets (excerpt from the download page of GIANT website). Each file consists of the following information for each SNP and its association to the specified trait based on meta-analysis in the respective publication. Significant digits for the p values, betas and standard errors are limited to two digits to further limit the possibility of identifiability. MarkerName: The dbSNP name of the genetic marker Allele1: The first allele (hg19 + strand). Where the regression coefficients (betas) are provided, the first allele is the effect allele. Where betas are not provided (typically the 2010 data), the first allele is the trait-increasing allele. Allele2: The second allele (hg19 + strand) Freq.Allele1.HapMapCEU: The allele frequency of Allele1 in the HapMap CEU population b: beta SE: standard error p: p-value after meta-analysis using regression coefficients (beta and standard error), and after correction for inflation of test statistics using genomic control both at the individual study level and again after meta-analysis N: Number of observations The file SNP_gwas_mc_merge_nogc.tbl.uniq.gz is used in this section. The following analyses have been performed on Body Mass Index (BMI) 2015 dataset. GSEA Round 1 (Section 6.1) GSEA Round 2 (Section 6.2) References "],
["bmi2015-1.html", "6.1 GSEA Round 1", " 6.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 6.1.1 Fit the null model I used the grids theta0=(-5:0.25:-1)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 68 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.6% posterior mass is concentrated on the setting (h=0.3, theta0=-4). 6.1.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-4), since the null analysis suggests that almost 99.6% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta = (0:0.02:4)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 6.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.6509 Min. :0.0600 Min. :0.660 ## 1st Qu.:1.3917 1st Qu.:0.7000 1st Qu.:1.955 ## Median :1.5990 Median :0.9100 Median :2.180 ## Mean :1.6163 Mean :0.9816 Mean :2.154 ## 3rd Qu.:1.7843 3rd Qu.:1.1000 3rd Qu.:2.345 ## Max. :2.8939 Max. :2.5800 Max. :3.220 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 61.0 ## 1st Qu.: 3.00 1st Qu.: 252.0 ## Median : 5.00 Median : 379.5 ## Mean : 7.56 Mean : 518.4 ## 3rd Qu.: 7.25 3rd Qu.: 549.0 ## Max. :116.00 Max. :5303.0 6.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["bmi2015-2.html", "6.2 GSEA Round 2", " 6.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 6.2.1 Fit the null model From the Round 1 null analysis (Section 6.1), I found that almost 99.6% posterior mass is concentrated on the setting (h=0.3, theta0=-4). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-4.25:0.025:-3.75)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.8% posterior mass is concentrated on the settings h=0.3 and theta0=(-4.2:0.025:-3.8)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-4.2,-3.8,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9979794 6.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-4.2:0.025:-3.8)', since the null analysis suggests that almost 99.8% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3.5/200):3.5)', based on the Round 1 enrichment analysis (Section 6.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["ibd2015.html", "7 Inflammatory Bowel Disease 2015", " 7 Inflammatory Bowel Disease 2015 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to J. Z. Liu et al. (2015) are provided by the International Inflammatory Bowel Disease Genetics Consortium (IIBDGC). Below is the basic information about these datasets (excerpt from the README of IIBDGC data). These files are the summary association statistics corresponding to Liu, van Sommeren et al, Nature Genetics, 2015. There are two groups of files: (1) GWAS meta-analyses, and (2) GWAS plus Immunochip trans-ancestry MANTRA meta-analyses. Each group has outputs for Crohn&#39;s disease (CD), ulcerative colitis (UC), and both inflammatory bowel diseases (IBD) together. Group 1 files: These files have been filtered to only include variants with INFO&gt;0.3 and with more than 2 studies/datasets inlcuded in the analysis. EUR.CD.gwas_info03_filtered.assoc.gz - European CD 1KGP imputed GWAS meta-analysis EUR.IBD.gwas_info03_filtered.assoc.gz - European IBD 1KGP imputed GWAS meta-analysis EUR.UC.gwas_info03_filtered.assoc.gz - European UC 1KGP imputed GWAS meta-analysis Columns: CHR - chromosome SNP - rsid BP - position in b37 A1 - effect allele A2 - other allele FRQ_A_XXXX - effect allele frequency in XXXX cases FRQ_U_XXXXX - effect allele frequency in XXXXX controls INFO - IMPUTE2 info score OR - odds ratio SE - standard error P - P value Direction - direction of effect in each study included int he meta-analysis HetISqt - Between study Heterogenity score - I squared HetPVa - P value for heterogeneity test nstudies - the maximum number of datasets/studies that could be included studies_included - the number of datasets/studies actually included in the analysis for this variant The following analyses have been performed on Inflammatory Bowel Disease (IBD) 2015 dataset. GSEA Round 1 (Section 7.1) GSEA Round 2 (Section 7.2) References "],
["ibd2015-1.html", "7.1 GSEA Round 1", " 7.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 7.1.1 Fit the null model I used the grids theta0=(-4:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 36 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.9% posterior mass is concentrated on the setting (h=0.3, theta0=-3). 7.1.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-3), since the null analysis suggests that almost 99.9% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta=(0:0.015:3)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 7.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.5612 Min. :0.3300 Min. :0.6300 ## 1st Qu.:0.7954 1st Qu.:0.5850 1st Qu.:0.9675 ## Median :0.9129 Median :0.7275 Median :1.1100 ## Mean :0.9645 Mean :0.7572 Mean :1.1501 ## 3rd Qu.:1.1211 3rd Qu.:0.8850 3rd Qu.:1.3200 ## Max. :1.5444 Max. :1.2900 Max. :1.8150 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 6.00 Min. : 517 ## 1st Qu.: 39.25 1st Qu.: 3228 ## Median : 60.50 Median : 5170 ## Mean : 85.85 Mean : 7326 ## 3rd Qu.:104.25 3rd Qu.: 9547 ## Max. :385.00 Max. :41009 7.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["ibd2015-2.html", "7.2 GSEA Round 2", " 7.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 7.2.1 Fit the null model From the Round 1 null analysis (Section 7.1), I found that almost 99.9% posterior mass is concentrated on the setting (h=0.3, theta0=-3). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-3.25:0.025:-2.75)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.9% posterior mass is concentrated on the settings h=0.3 and theta0=(-3:0.025:-2.8)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-3,-2.8,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9998194 7.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-3:0.025:-2.8)', since the null analysis suggests that almost 99.9% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(2/100):2)', based on the Round 1 enrichment analysis (Section 7.1). The following table lists the GSEA results of the top 100 enriched pathways identified from the Round 1 analysis. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["cad2015.html", "8 Coronary Artery Disease 2015", " 8 Coronary Artery Disease 2015 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Nikpay et al. (2015) are provided by the Coronary ARtery DIsease Genome wide Replication and Meta-analysis (CARDIoGRAM) plus The Coronary Artery Disease (C4D) Genetics (CARDIoGRAMplusC4D) consortium. Below is the basic information about these datasets (excerpt from the download page of CARDIoGRAMplusC4D website). CARDIoGRAMplusC4D 1000 Genomes-based GWAS is a meta-analysis of GWAS studies of mainly European, South Asian, and East Asian, descent imputed using the 1000 Genomes phase 1 v3 training set with 38 million variants. The study interrogated 9.4 million variants and involved 60,801 CAD cases and 123,504 controls. Data as published in: CARDIoGRAMplusC4D Consortium, M Nikpey, A Goel, H Won, LM Hall C. Willenborg, S Kanoni, D Saleheen et al. A comprehensive 1000 Genomes–based genome-wide association meta-analysis of coronary artery disease. Nat Genet 2015 47:1121-1130. ( c ) 1000 Genomes-based GWAS Markername, chr, bp_hg19, effect_allele, noneffect_allele, effect_allele_freq, median_info, model, beta, se_dgc, p_dgc, het_pvalue, n_studies. The 3 results files correspond to (i) all cases analysed with an additive model, (ii) all cases analysed with a recessive model, and (iii) all MI cases with an additive model. In the C4D GWA meta-analysis and the 1000 Genomes-based GWAS meta-analyses adjustment was for study-specific covariates only. median_info: Median imputation quality based on all particiapting studies model: fixed/random effects se_dgc: standard error (double genomic controlled) p_dgc: Association p-value based on beta &amp; se_dgc het_pvalue: Heterogeneity p-value The input dataset for this section is CARDIoGRAMplusC4D 1000 Genomes-based GWAS - Additive. The following analyses have been performed on Coronary Artery Disease (CAD) 2015 dataset. GSEA Round 1 (Section 8.1) GSEA Round 2 (Section 8.2) References "],
["cad2015-1.html", "8.1 GSEA Round 1", " 8.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 8.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 36 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.8 % posterior mass is concentrated on the setting (h=0.3, theta0=-4). 8.1.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-4), since the null analysis suggests that almost 99.8% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta=(0:0.02:4)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 8.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.2571 Min. :0.000 Min. :0.540 ## 1st Qu.:0.9993 1st Qu.:0.600 1st Qu.:1.475 ## Median :1.4982 Median :1.230 Median :1.680 ## Mean :1.3945 Mean :1.103 Mean :1.671 ## 3rd Qu.:1.6507 3rd Qu.:1.500 3rd Qu.:1.960 ## Max. :3.2024 Max. :3.200 Max. :3.220 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 242 ## 1st Qu.: 13.00 1st Qu.: 1257 ## Median : 32.00 Median : 2880 ## Mean : 60.42 Mean : 5879 ## 3rd Qu.: 62.75 3rd Qu.: 5891 ## Max. :496.00 Max. :51734 8.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["cad2015-2.html", "8.2 GSEA Round 2", " 8.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 8.2.1 Fit the null model From the Round 1 null analysis (Section 8.1), I found that almost 99.8% posterior mass is concentrated on the setting (h=0.3, theta0=-4). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-4.25:0.25:-3.75)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.5% posterior mass is concentrated on the settings h=0.3 and theta0=(-4.025:0.025:-3.775)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-4.025,-3.775,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9950132 8.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-4.025:0.025:-3.775)', since the null analysis suggests that almost 99.5% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta=(0:(3.5/100):3.5)', based on the Round 1 enrichment analysis (Section 8.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["alzheimers-disease-2013.html", "9 Alzheimer’s Disease 2013", " 9 Alzheimer’s Disease 2013 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Lambert et al. (2013) are provided by the International Genomics of Alzheimer’s Project (IGAP). Below is the basic information about these datasets (excerpt from the download page of IGAP). Two dataset are provided. The first one corresponds to the meta-analysis results obtained in stage 1 including genotyped and imputed data (7,055,881 single nucleotide polymorphisms, 1000G phase 1 alpha imputation, Build 37, Assembly Hg19) of 17,008 Alzheimer&#39;s disease cases and 37,154 controls. The second one corresponds to the meta-analysis results of the 11,632 SNPs that were genotyped and tested for association in an independent set of 8,572 Alzheimer&#39;s disease cases and 11,312 controls with the combined stage1/stage2 P-values. Each file consists of the following information for each SNP and its association to Alzheimer&#39;s disease based on meta-analysis in the publication mentioned below. Although the individual datasets examined excluded any SNPs with call rates &lt;95%, IGAP meta-analysis only analyzed SNPs either genotyped or successfully imputed in at least 40% of the AD cases and 40 % of the control samples across all datasets. Chromosome: Chromosome of the SNP (Build 37, Assembly Hg19) Position: Position of the SNP (Build 37, Assembly Hg19) MarkerName: SNP rsID or chromosome:position if rsID not available Effect_allele: Reference allele (coded allele) Non_Effect_allele: Non reference allele (non coded allele) Beta: Overall estimated effect size for the effect allele SE: Overall standard error for effect size estimate Pvalue: Meta-analysis Pvalue using regression coefficients (beta and standard error) We only use the data from stage 1 in our analyses. The following analyses have been performed on Alzheimer’s Disease 2013 dataset. GSEA Round 1 (Section 9.1) GSEA Round 2 (Section 9.2) References "],
["load2013-1.html", "9.1 GSEA Round 1", " 9.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 9.1.1 Fit the null model I used the grids theta0=(-5.25:0.25:-3.25)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 36 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 92.5% posterior mass is concentrated on the setting (h=0.6, theta0=-5). 9.1.2 Fit the enrichment model To perform GSEA, I set (h=0.6, theta0=-5), since the null analysis suggests that almost 92.5% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta=(0:0.025:5)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 9.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :1.189 Min. :0.475 Min. :1.400 ## 1st Qu.:1.481 1st Qu.:0.825 1st Qu.:1.894 ## Median :1.845 Median :1.512 Median :2.150 ## Mean :1.888 Mean :1.480 Mean :2.256 ## 3rd Qu.:2.191 3rd Qu.:1.850 3rd Qu.:2.606 ## Max. :3.759 Max. :3.750 Max. :3.800 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 283 ## 1st Qu.: 12.50 1st Qu.: 1160 ## Median : 26.50 Median : 2612 ## Mean : 40.25 Mean : 4289 ## 3rd Qu.: 49.25 3rd Qu.: 5168 ## Max. :252.00 Max. :26056 9.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["load2013-2.html", "9.2 GSEA Round 2", " 9.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 9.2.1 Fit the null model From the Round 1 null analysis (Section 9.1), I found that almost 92.5% posterior mass is concentrated on the setting (h=0.6, theta0=-5). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-5.25:0.025:-4.75)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.6 and theta0=(-5.150:0.025:-5.075)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-5.150,-5.075,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999736 9.2.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=(-5.150:0.025:-5.075)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(4/400):4)'. The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["waist-to-hip-ratio-2015.html", "10 Waist-to-Hip Ratio 2015", " 10 Waist-to-Hip Ratio 2015 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 6. The following analyses have been performed on Waist-to-Hip Ratio adjusted for BMI (WHRadjBMI) 2015 dataset. GSEA Round 1 (Section 10.1) GSEA Round 2 (Section 10.2) "],
["waist2015-1.html", "10.1 GSEA Round 1", " 10.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 10.1.1 Fit the null model I used the grids theta0=(-5.25:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 56 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the setting (h=0.3, theta0=-3). 10.1.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-3), since the null analysis suggests that almost 100% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta=(0:0.015:3)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 10.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.02612 Min. :0.0000 Min. :0.0750 ## 1st Qu.:0.35687 1st Qu.:0.1163 1st Qu.:0.4612 ## Median :0.69050 Median :0.4350 Median :0.9225 ## Mean :0.84047 Mean :0.6569 Mean :1.0294 ## 3rd Qu.:1.14854 3rd Qu.:1.1175 3rd Qu.:1.5112 ## Max. :2.93735 Max. :2.9250 Max. :2.9850 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 77.0 ## 1st Qu.: 7.00 1st Qu.: 551.8 ## Median : 26.50 Median : 2371.5 ## Mean : 56.74 Mean : 5120.7 ## 3rd Qu.: 94.50 3rd Qu.: 8113.0 ## Max. :344.00 Max. :33015.0 10.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["waist2015-2.html", "10.2 GSEA Round 2", " 10.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 10.2.1 Fit the null model From the Round 1 null analysis (Section 10.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.3, theta0=-3). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-3.25:0.025:-2.75)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.3 and theta0=(-3:0.025:-2.95)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-3,-2.95,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 1 10.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-3:0.025:-2.95)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(3/300):3)', based on the Round 1 enrichment analysis (Section 10.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["neu2016.html", "11 Neuroticism 2016", " 11 Neuroticism 2016 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Okbay et al. (2016) are provided by the Social Science Genetic Association Consortium (SSGAC). Below is the basic information about these datasets (excerpt from the README of SSGAC data). To limit the possibilities of identifiability, significant digits for betas and standard errors are restrcted to three decimal places, and no sample allele frequencies are provided (the reported allele frequencies are from the CEU, GBR and TSI populations in the 1000G sample). For SNPs passing quality control, we provide results from these four meta-analyses: 1. SWB_Full.txt --- subjective well-being meta-analysis of all cohorts except 23andMe. All SNPs. 2. SWB_10K.txt --- subjective well-being meta-analysis of all cohorts. Pruned set of 10,000 SNPs. 3. Neuroticism_Full.txt --- neuroticism meta-analysis of all cohorts. All SNPs. 4. DS_Full.txt --- depressive symptoms meta-analysis of all cohorts. All SNPs. Each file consists of the following columns: MarkerName: SNP rs number. CHR: chromosome number. POS: base pair position. A1: effect allele. A2: other allele. EAF: A1 frequency in 1000G sample (CEU, GBR and TSI individuals). Beta: Standardized regression coefficient. SE: standard error of beta. Pval: Nominal p-value of the null hypothesis that the coefficient is equal to zero. The following analyses have been performed on Neuroticism (NEU) 2016 dataset. GSEA Round 1 (Section 11.1) GSEA Round 2 (Section 11.2) References "],
["neu2016-1.html", "11.1 GSEA Round 1", " 11.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 11.1.1 Fit the null model I used the grids theta0=(-4.5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 44 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=[0.3 0.4] and theta0=[-4 -4.25 -4.5]. 11.1.2 Fit the enrichment model To perform GSEA, I use a smaller grid that includes h=[0.3 0.4] and theta0=[-4 -4.25 -4.5], since the null analysis suggests that almost 100% posterior mass is placed on thses settings. For the log-fold enrichment parameter, I use the grid theta = (0:0.1:4)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 11.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.3160 Min. :0.000 Min. :0.700 ## 1st Qu.:0.8626 1st Qu.:0.100 1st Qu.:1.500 ## Median :1.4176 Median :0.500 Median :2.200 ## Mean :1.6175 Mean :0.953 Mean :2.174 ## 3rd Qu.:2.3378 3rd Qu.:1.625 3rd Qu.:2.900 ## Max. :3.6000 Max. :3.500 Max. :3.600 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 96.0 ## 1st Qu.: 3.00 1st Qu.: 227.8 ## Median : 9.50 Median : 926.5 ## Mean : 24.33 Mean : 2434.8 ## 3rd Qu.: 31.25 3rd Qu.: 2722.8 ## Max. :190.00 Max. :19483.0 11.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["neu2016-2.html", "11.2 GSEA Round 2", " 11.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 11.2.1 Fit the null model From the Round 1 null analysis (Section 11.1), I found that almost 99.9% posterior mass is concentrated on the settings h=0.3 and theta0=[-4 -4.25 -4.5]. In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-4.5:0.025:-4)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 44 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that the posterior mass is almost uniformly scattered on the settings h=0.3 and theta0=(-4.5:0.025:-4)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-4.5,-4,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 1 11.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-4.5:0.025:-4)', since the null analysis suggests that the posterior mass is almost uniformly placed on thses settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3.7/100):3.7)', based on the Round 1 enrichment analysis (Section 11.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["rheumatoid-arthritis-2014.html", "12 Rheumatoid Arthritis 2014", " 12 Rheumatoid Arthritis 2014 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Okada et al. (2014) are provided by Dr. Yukinori Okada. We only use the Eurpean GWAS meta-analysis results in this section. The following analyses have been performed on Rheumatoid Arthritis (RA) 2014 dataset. GSEA Round 1 (Section 12.1) GSEA Round 2 (Section 12.2) References "],
["ra2014-1.html", "12.1 GSEA Round 1", " 12.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 12.1.1 Fit the null model I used the grids theta0=(-4.5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 44 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the setting (h=0.3, theta0=-3.25). 12.1.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-3.25), since the null analysis suggests that almost 100% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta=(0:0.01625:3.25)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 12.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.2348 Min. :0.0000 Min. :0.4225 ## 1st Qu.:0.6707 1st Qu.:0.4875 1st Qu.:0.8287 ## Median :0.8248 Median :0.5850 Median :1.1375 ## Mean :0.8675 Mean :0.5965 Mean :1.1074 ## 3rd Qu.:1.1028 3rd Qu.:0.7841 3rd Qu.:1.3528 ## Max. :1.5054 Max. :1.4138 Max. :1.7550 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 3.00 Min. : 278 ## 1st Qu.: 21.00 1st Qu.: 1602 ## Median : 49.50 Median : 4748 ## Mean : 77.81 Mean : 6915 ## 3rd Qu.:102.25 3rd Qu.:10247 ## Max. :359.00 Max. :30457 12.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["ra2014-2.html", "12.2 GSEA Round 2", " 12.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 12.2.1 Fit the null model From the Round 1 null analysis (Section 12.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.3, theta0=-3.25). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-3.5:0.025:-3)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.3 and theta0=(-3.25:0.025:-3.175)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-3.25,-3.175,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999712 12.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-3.25:0.025:-3.175)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(2/200):2)', based on the Round 1 enrichment analysis (Section 12.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["type-2-diabetes-2012.html", "13 Type 2 Diabetes 2012", " 13 Type 2 Diabetes 2012 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Morris et al. (2012) are provided by the DIAbetes Genetics Replication And Meta-analysis (DIAGRAM) consortium. The basic information about these datasets is available here. The following analyses have been performed on Type 2 Diabetes 2012 dataset. GSEA Round 1 (Section 13.1) GSEA Round 2 (Section 13.2) References "],
["t2d2012-1.html", "13.1 GSEA Round 1", " 13.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 13.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=[0.4 0.5 0.6] and theta0 = -4.5. 13.1.2 Fit the enrichment model To perform GSEA, I set h=[0.4 0.5 0.6] and theta0 = -4.5, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(4.5/67):4.5)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 13.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.7471 Min. :0.2015 Min. :1.209 ## 1st Qu.:1.7463 1st Qu.:1.7463 1st Qu.:1.813 ## Median :1.8134 Median :1.8134 Median :1.881 ## Mean :1.7988 Mean :1.7563 Mean :1.893 ## 3rd Qu.:1.8807 3rd Qu.:1.8806 3rd Qu.:1.948 ## Max. :2.6866 Max. :2.6866 Max. :2.687 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 4.00 Min. : 392 ## 1st Qu.:20.00 1st Qu.:1638 ## Median :32.00 Median :2808 ## Mean :38.45 Mean :3364 ## 3rd Qu.:56.00 3rd Qu.:4986 ## Max. :88.00 Max. :7910 13.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["t2d2012-2.html", "13.2 GSEA Round 2", " 13.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 13.2.1 Fit the null model From the Round 1 null analysis (Section 13.1), I found that almost 95.3% posterior mass is concentrated on the settings h=[0.4 0.5 0.6] and theta0=-4.5. In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-4.75:0.025:-4.25)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 84 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.8% posterior mass is concentrated on the settings h=(0.3:0.1:0.6)' and theta0=(-4.75:0.025:-4.35)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-4.75,-4.35,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9977516 13.2.2 Fit the enrichment model To perform GSEA, I set h=(0.3:0.1:0.6)' and theta0=(-4.75:0.025:-4.35)', since the null analysis suggests that almost 99.8% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3/60):3)'. The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["heart-rate-2013.html", "14 Heart Rate 2013", " 14 Heart Rate 2013 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The following analyses have been performed on Heart Rate 2013 dataset. GSEA Round 1 (Section 14.1) GSEA Round 2 (Section 14.2) "],
["hr2013-1.html", "14.1 GSEA Round 1", " 14.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 14.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.1% posterior mass is concentrated on the combinations of h=[0.3 0.4] and theta0=[-4.5 -4.25]. 14.1.2 Fit the enrichment model To perform GSEA, I set h=[0.3 0.4] and theta0=[-4.5 -4.25], since the null analysis suggests that almost 99.1% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(4.5/50):4.5)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 14.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.8098 Min. :0.0000 Min. :1.260 ## 1st Qu.:1.0912 1st Qu.:0.3600 1st Qu.:1.620 ## Median :1.3554 Median :0.5400 Median :1.980 ## Mean :1.4455 Mean :0.7416 Mean :2.038 ## 3rd Qu.:1.7042 3rd Qu.:0.9000 3rd Qu.:2.340 ## Max. :3.4200 Max. :3.4200 Max. :3.510 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 121.0 ## 1st Qu.: 6.00 1st Qu.: 509.5 ## Median : 28.50 Median : 2360.0 ## Mean : 50.10 Mean : 5091.5 ## 3rd Qu.: 69.25 3rd Qu.: 6240.8 ## Max. :231.00 Max. :22851.0 14.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["hr2013-2.html", "14.2 GSEA Round 2", " 14.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 14.2.1 Fit the null model From the Round 1 null analysis (Section 14.1), I found that almost 99.1% posterior mass is concentrated on the settings h=[0.3 0.4] and theta0=[-4.5 -4.25]. In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-4.5:0.025:-4)' and h=[0.3 0.4] when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 42 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.8% posterior mass is concentrated on the settings h=[0.3 0.4] and theta0=(-4.5:0.025:-4.1)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-4.5,-4.1,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9977206 14.2.2 Fit the enrichment model To perform GSEA, I set h=[0.3 0.4] and theta0=(-4.5:0.025:-4.1)', since the null analysis suggests that almost 99.8% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(3.8/100):3.8)', based on the Round 1 enrichment analysis (Section 14.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["crohns-disease-2015.html", "15 Crohn’s Disease 2015", " 15 Crohn’s Disease 2015 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 7. The following analyses have been performed on Crohn’s Disease (CD) 2015 dataset. GSEA Round 1 (Section 15.1) GSEA Round 2 (Section 15.2) "],
["cd2015-1.html", "15.1 GSEA Round 1", " 15.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 15.1.1 Fit the null model I used the grids theta0=(-4:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 36 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the setting (h=0.3, theta0=-3). 15.1.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-3), since the null analysis suggests that almost 100% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta=(0:0.015:3)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 15.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.4548 Min. :0.3600 Min. :0.630 ## 1st Qu.:0.7897 1st Qu.:0.7163 1st Qu.:0.885 ## Median :0.9938 Median :0.8100 Median :1.200 ## Mean :1.0381 Mean :0.8666 Mean :1.193 ## 3rd Qu.:1.2437 3rd Qu.:0.9487 3rd Qu.:1.410 ## Max. :1.7516 Max. :1.5900 Max. :1.920 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 8.00 Min. : 869 ## 1st Qu.: 25.75 1st Qu.: 1958 ## Median : 65.50 Median : 5158 ## Mean : 93.08 Mean : 8352 ## 3rd Qu.:147.25 3rd Qu.:11058 ## Max. :406.00 Max. :42311 15.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["cd2015-2.html", "15.2 GSEA Round 2", " 15.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 15.2.1 Fit the null model From the Round 1 null analysis (Section 15.1), I found that almost 99.9% posterior mass is concentrated on the setting (h=0.3, theta0=-3). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-3.25:0.025:-2.75)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.99% posterior mass is concentrated on the setting (h=0.3, theta0=-3). theta0.index &lt;- as.character(null.df$theta0) %in% as.character(-3) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999182 15.2.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-3), since the null analysis suggests that almost 100% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta=(0:(2/200):2)', based on the Round 1 enrichment analysis (Section 15.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["ulcerative-colitis-2015.html", "16 Ulcerative Colitis 2015", " 16 Ulcerative Colitis 2015 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 7. The following analyses have been performed on Ulcerative Colitis (UC) 2015 dataset. GSEA Round 1 (Section 16.1) GSEA Round 2 (Section 16.2) "],
["uc2015-1.html", "16.1 GSEA Round 1", " 16.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 16.1.1 Fit the null model I used the grids theta0=(-4:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 36 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.8% posterior mass is concentrated on the setting (h=0.3, theta0=-3). 16.1.2 Fit the enrichment model To perform GSEA, I set (h=0.3, theta0=-3), since the null analysis suggests that almost 99.8% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta=(0:0.015:3)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 16.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.4408 Min. :0.0000 Min. :0.600 ## 1st Qu.:0.7717 1st Qu.:0.4800 1st Qu.:1.005 ## Median :0.8764 Median :0.6450 Median :1.155 ## Mean :0.9179 Mean :0.6324 Mean :1.178 ## 3rd Qu.:1.0460 3rd Qu.:0.7800 3rd Qu.:1.320 ## Max. :1.9471 Max. :1.4550 Max. :2.295 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.0 Min. : 117 ## 1st Qu.: 28.0 1st Qu.: 1954 ## Median : 49.0 Median : 3700 ## Mean : 68.3 Mean : 5566 ## 3rd Qu.: 78.0 3rd Qu.: 6636 ## Max. :385.0 Max. :41508 16.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["uc2015-2.html", "16.2 GSEA Round 2", " 16.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 16.2.1 Fit the null model From the Round 1 null analysis (Section 16.1), I found that almost 99.8% posterior mass is concentrated on the setting (h=0.3, theta0=-3). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-3.25:0.025:-2.75)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.8% posterior mass is concentrated on the settings h=0.3 and theta0=(-3.175:0.025:-2.775)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-3.175,-2.775,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9987888 16.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-3.175:0.025:-2.775)', since the null analysis suggests that almost 99.9% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(2.5/100):2.5)', based on the Round 1 enrichment analysis (Section 16.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["myocardial-infarction-2015.html", "17 Myocardial Infarction 2015", " 17 Myocardial Infarction 2015 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 8. The following analyses have been performed on Myocardial Infarction (MI) 2015 dataset. GSEA Round 1 (Section 17.1) GSEA Round 2 (Section 17.2) "],
["mi2015-1.html", "17.1 GSEA Round 1", " 17.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 17.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 36 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 98.6 % posterior mass is concentrated on the settings (h=0.3, theta0=-4), (h=0.3, theta0=-4.25) and (h=0.3, theta0=-4.5). 17.1.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-4.5:0.25:-4), since the null analysis suggests that almost 98.6% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(4.5/67):4.5)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 17.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.1639 Min. :0.0000 Min. :0.5373 ## 1st Qu.:0.8813 1st Qu.:0.1175 1st Qu.:1.4104 ## Median :1.6235 Median :0.9403 Median :2.0821 ## Mean :1.5884 Mean :1.0592 Mean :2.0398 ## 3rd Qu.:1.8774 3rd Qu.:1.4104 3rd Qu.:2.4179 ## Max. :4.5000 Max. :4.4328 Max. :4.5000 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 68.0 ## 1st Qu.: 7.00 1st Qu.: 729.2 ## Median : 16.50 Median : 1395.5 ## Mean : 49.52 Mean : 4047.8 ## 3rd Qu.: 59.00 3rd Qu.: 4945.0 ## Max. :463.00 Max. :35574.0 17.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["mi2015-2.html", "17.2 GSEA Round 2", " 17.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 17.2.1 Fit the null model From the Round 1 null analysis (Section 17.1), I found that almost 98.6% posterior mass is concentrated on the settings h=0.3 and theta0=(-4.5:0.25:-4). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-4.5:0.025:-4)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 42 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.9% posterior mass is concentrated on the settings h=0.3 and theta0=(-4.475:0.025:-4)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-4.475,-4,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9992546 17.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-4.475:0.025:-4)', since the null analysis suggests that almost 99.9% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(4.5/100):4.5)', based on the Round 1 enrichment analysis (Section 17.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["depressive-symptoms-2016.html", "18 Depressive Symptoms 2016", " 18 Depressive Symptoms 2016 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 11. The following analyses have been performed on Depressive Symptoms (DS) 2016 dataset. GSEA Round 1 (Section 18.1) GSEA Round 2 (Section 18.2) "],
["ds2016-1.html", "18.1 GSEA Round 1", " 18.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 18.1.1 Fit the null model I used the grids theta0=(-6:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 68 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=[0.3 0.4 0.5 0.6] and theta0 = (-6:0.25:-5)'. 18.1.2 Fit the enrichment model To perform GSEA, I use a smaller grid that includes h=[0.3 0.4 0.5 0.6] and theta0 = (-6:0.25:-5)', since the null analysis suggests that almost 100% posterior mass is placed on thses settings. For the log-fold enrichment parameter, I use the grid theta=(0:(6/10):6)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 18.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :2.588 Min. :1.200 Min. :3.000 ## 1st Qu.:3.192 1st Qu.:2.400 1st Qu.:3.600 ## Median :3.429 Median :3.000 Median :4.200 ## Mean :3.528 Mean :2.874 Mean :4.104 ## 3rd Qu.:3.599 3rd Qu.:3.000 3rd Qu.:4.200 ## Max. :6.000 Max. :6.000 Max. :6.000 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 52.0 ## 1st Qu.: 2.00 1st Qu.: 186.5 ## Median : 3.00 Median : 251.5 ## Mean : 3.94 Mean : 326.3 ## 3rd Qu.: 5.00 3rd Qu.: 376.5 ## Max. :13.00 Max. :1250.0 18.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["ds2016-2.html", "18.2 GSEA Round 2", " 18.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 18.2.1 Fit the null model From the Round 1 null analysis (Section 18.1), I found that almost 99.9% posterior mass is concentrated on the settings h=(0.3:0.1:0.6)' and theta0 = (-6:0.25:-5)'. In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-6:0.05:-5)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 84 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that the posterior mass is almost uniformly placed on the settings h=(0.3:0.1:0.6)' and theta0 = (-6:0.25:-5)'. 18.2.2 Fit the enrichment model To perform GSEA, I use a smaller grid that includes h=(0.3:0.1:0.6)' and theta0 = (-6:0.05:-5)', since the null analysis suggests that almost 100% posterior mass is placed on thses settings. For the log-fold enrichment parameter, I use the grid theta=(0:(6/20):6)'. The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["red-blood-cell-count-2012.html", "19 Red Blood Cell Count 2012", " 19 Red Blood Cell Count 2012 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The following analyses have been performed on Red Blood Cell Count (RBC) 2012 dataset. GSEA Round 1 (Section 19.1) GSEA Round 2 (Section 19.2) "],
["rbc2012-1.html", "19.1 GSEA Round 1", " 19.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 19.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=[0.3 0.4 0.5 0.6] and theta0 = -3.5. 19.1.2 Fit the enrichment model To perform GSEA, I set h=[0.3 0.4 0.5 0.6] and theta0 = -3.5, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3.5/50):3.5)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 19.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.05975 Min. :0.000 Min. :0.210 ## 1st Qu.:0.77886 1st Qu.:0.595 1st Qu.:0.980 ## Median :1.47000 Median :1.365 Median :1.610 ## Mean :1.50459 Mean :1.387 Mean :1.629 ## 3rd Qu.:2.30826 3rd Qu.:2.240 3rd Qu.:2.310 ## Max. :3.29000 Max. :3.220 Max. :3.290 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 176 ## 1st Qu.: 12.75 1st Qu.: 1210 ## Median : 18.50 Median : 1669 ## Mean : 45.77 Mean : 4656 ## 3rd Qu.: 44.00 3rd Qu.: 4027 ## Max. :385.00 Max. :42856 19.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["rbc2012-2.html", "19.2 GSEA Round 2", " 19.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 19.2.1 Fit the null model From the Round 1 null analysis (Section 7.1), I found that almost 99.9% posterior mass is concentrated on the settings theta0=-3.5 and h=(0.3:0.1:0.6)'. In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-3.75:0.025:-3.25)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 84 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.97% of the posterior mass is concentrated on the settings theta0=(-3.7:0.025:-3.6)' and h=(0.5:0.1:0.6)'. h.index &lt;- as.character(null.df$h) %in% as.character(c(0.5,0.6)) theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-3.7,-3.6,by=0.025)) sum(null.df$posp.step1[intersect(theta0.index, h.index)]) ## [1] 0.9996216 sum(null.df$posp.step2[intersect(theta0.index, h.index)]) ## [1] 0.9996749 19.2.2 Fit the enrichment model To perform GSEA, I set theta0=(-3.7:0.025:-3.6)' and h=(0.5:0.1:0.6)', since the null analysis suggests that almost 99.97% of the posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3.5/100):3.5)'. The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["urate2013.html", "20 Serum Urate 2013", " 20 Serum Urate 2013 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Köttgen et al. (2013) are provided by the Global Urate Genetics Consortium (GUGC). Below is the basic information about these datasets (excerpt from the README of GUGC data). 1. GUGC_MetaAnalysis_Results_UA.csv This file contains the summary statistics for association with serum urate concentrations from meta-analysis of up to 110,347 individuals from 48 studies. It has the following headers: MarkerName: rs identifier of the SNP n_total: number of individuals with available SNP information A1: the modeled allele, i.e. the allele to which the beta estimate refers to A2: the other allele beta: effect of each additional copy of A1 on serum urate concentrations in mg/dl se: standard error of the beta p_gc: genomic control corrected p-value for association 2. GUGC_MetaAnalysis_Results_Gout.csv This file contains the summary statistics for association with gout from meta-analysis of up to 2,115 gout cases and 67,259 controls from 14 studies. It has the following headers: MarkerName: rs identifier of the SNP n_total: number of individuals with available SNP information A1: the modeled allele, i.e. the allele to which the beta estimate refers to A2: the other allele beta: log odds of each additional copy of A1. To obtain the odds ratio for gout per allele, exponentiate the beta. OR = exp(beta) se: standard error of the beta p_gc: genomic control corrected p-value for association The following analyses have been performed on Serum Urate 2013 dataset. GSEA Round 1 (Section 20.1) GSEA Round 2 (Section 20.2) References "],
["urate2013-1.html", "20.1 GSEA Round 1", " 20.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 20.1.1 Fit the null model I used the grids theta0=(-5.5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the combinations of h=0.5 and theta0=-5.25. 20.1.2 Fit the enrichment model To perform GSEA, I set h=0.5 and theta0=-5.25, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(5.25/200):5.25)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 20.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.630 Min. :0.3412 Min. :0.630 ## 1st Qu.:1.457 1st Qu.:1.2994 1st Qu.:1.621 ## Median :2.179 Median :1.8113 Median :2.428 ## Mean :2.255 Mean :2.0026 Mean :2.472 ## 3rd Qu.:3.025 3rd Qu.:2.7956 3rd Qu.:3.327 ## Max. :4.226 Max. :4.2263 Max. :4.253 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 85.0 ## 1st Qu.: 10.75 1st Qu.: 946.8 ## Median : 40.50 Median : 3720.5 ## Mean : 79.08 Mean : 7471.7 ## 3rd Qu.: 98.00 3rd Qu.: 7643.0 ## Max. :496.00 Max. :47869.0 20.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["urate2013-2.html", "20.2 GSEA Round 2", " 20.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 20.2.1 Fit the null model From the Round 1 null analysis (Section 20.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.5, theta0=-5.25). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-5.5:0.025:-5)' and h=0.5 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the combinations of h=0.5 and theta0=(-5.4:0.025:-5)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-5.4,-5,by=0.025)) sum(null.df$posp.step1[theta0.index]) ## [1] 1 sum(null.df$posp.step2[theta0.index]) ## [1] 1 20.2.2 Fit the enrichment model To perform GSEA, I set h=0.5 and theta0=(-5.4:0.025:-5)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(4.7/180):4.7)', based on the Round 1 enrichment analysis (Section 20.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["hdl2010.html", "21 High-density Lipoprotein 2010", " 21 High-density Lipoprotein 2010 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Teslovich et al. (2010) are provided by the Global Lipids Genetics Consortium (GLGC). The basic information about these datasets is available here. The following analyses have been performed on High-density Lipoprotein Cholesterol (HDL-C) 2010 dataset. GSEA Round 1 (Section 21.1) GSEA Round 2 (Section 21.2) References "],
["hdl2010-1.html", "21.1 GSEA Round 1", " 21.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 21.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the combinations of h=0.3 and theta0=-3.5. 21.1.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=-3.5, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3.5/200):3.5)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 21.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.8088 Min. :0.2975 Min. :0.980 ## 1st Qu.:1.2149 1st Qu.:0.9931 1st Qu.:1.448 ## Median :1.3458 Median :1.0850 Median :1.610 ## Mean :1.4466 Mean :1.2464 Mean :1.651 ## 3rd Qu.:1.6625 3rd Qu.:1.5706 3rd Qu.:1.873 ## Max. :2.5663 Max. :2.5375 Max. :2.678 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 242 ## 1st Qu.: 17.00 1st Qu.: 1406 ## Median : 31.50 Median : 2342 ## Mean : 51.21 Mean : 3803 ## 3rd Qu.: 60.25 3rd Qu.: 4949 ## Max. :359.00 Max. :25071 21.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["hdl2010-2.html", "21.2 GSEA Round 2", " 21.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 21.2.1 Fit the null model From the Round 1 null analysis (Section 21.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.3, theta0=-3.5). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-3.75:0.025:-3.25)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.3 and theta0=(-3.575:0.025:-3.5)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-3.575,-3.5,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999943 21.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-3.575:0.025:-3.5)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(3/300):3)'. The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["ligh-density-lipoprotein-2010.html", "22 Ligh-density Lipoprotein 2010", " 22 Ligh-density Lipoprotein 2010 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 21. The following analyses have been performed on Ligh-density Lipoprotein Cholesterol (LDL-C) 2010 dataset. GSEA Round 1 (Section 22.1) GSEA Round 2 (Section 22.2) "],
["ldl2010-1.html", "22.1 GSEA Round 1", " 22.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 22.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the combinations of h=0.3 and theta0=-3.75. 22.1.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=-3.75, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3.75/200):3.75)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 22.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.6728 Min. :0.1313 Min. :0.8438 ## 1st Qu.:1.0962 1st Qu.:0.8297 1st Qu.:1.2891 ## Median :1.3025 Median :1.1062 Median :1.4438 ## Mean :1.3810 Mean :1.1449 Mean :1.5921 ## 3rd Qu.:1.6212 3rd Qu.:1.2937 3rd Qu.:1.8703 ## Max. :2.6185 Max. :2.5312 Max. :2.7188 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 153 ## 1st Qu.: 22.00 1st Qu.: 1836 ## Median : 49.50 Median : 4512 ## Mean : 73.29 Mean : 6772 ## 3rd Qu.: 96.75 3rd Qu.: 9419 ## Max. :496.00 Max. :46250 22.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["ldl2010-2.html", "22.2 GSEA Round 2", " 22.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 22.2.1 Fit the null model From the Round 1 null analysis (Section 22.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.3, theta0=-3.75). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-3.5:0.025:-4)' and h=0.3 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.3 and theta0=(-3.625:0.025:-3.55)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-3.625,-3.55,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999998 22.2.2 Fit the enrichment model To perform GSEA, I set h=0.3 and theta0=(-3.625:0.025:-3.55)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3/300):3)', based on the Round 1 enrichment analysis (Section 22.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["age-at-natural-menopause-2015.html", "23 Age at Natural Menopause 2015", " 23 Age at Natural Menopause 2015 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Day et al. (2015) are provided by the Reproductive Genetics (ReproGen) Consortium. The following analyses have been performed on Age at Natural Menopause (ANM) 2015 dataset. GSEA Round 1 (Section 23.1) GSEA Round 2 (Section 23.2) References "],
["anm2015-1.html", "23.1 GSEA Round 1", " 23.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 23.1.1 Fit the null model I used the grids theta0=(-6:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 68 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the setting (h=0.4, theta0=-5.5). 23.1.2 Fit the enrichment model To perform GSEA, I set (h=0.4, theta0=-5.5), since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(5.5/200):5.5)'. The following table lists the GSEA results. 23.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["anm2015-2.html", "23.2 GSEA Round 2", " 23.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 23.2.1 Fit the null model From the Round 1 null analysis (Section 23.1), I found that almost 99.9% posterior mass is concentrated on the setting (h=0.4, theta0=-5.5). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-5.75:0.025:-5.25)' and h=0.4 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.4 and theta0=(-5.75:0.025:-5.7)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-5.75,-5.7,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 1 23.2.2 Fit the enrichment model To perform GSEA, I set (h=0.4, theta0=-5.5), since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(5.5/200):5.5)'. The following table lists the GSEA results. gsea.path &lt;- &quot;~/Dropbox/rss/Data/anm_2015/pathway/anm2015_pathway_201609.mat&quot; gsea.df &lt;- gsea.mat2df(gsea.path) source(&quot;src/gsea_dt.R&quot;) gsea.dt -->"],
["total-cholesterol-2010.html", "24 Total Cholesterol 2010", " 24 Total Cholesterol 2010 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 21. The following analyses have been performed on Total Cholesterol (TC) 2010 dataset. GSEA Round 1 (Section 24.1) GSEA Round 2 (Section 24.2) "],
["tc2010-1.html", "24.1 GSEA Round 1", " 24.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 24.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that more than 99.9% posterior mass is concentrated on the combinations of h=0.6 and theta0=-4.75. 24.1.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=-4.75, since the null analysis suggests that more than 99.9% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(4.75/200):4.75)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 24.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.02375 Min. :0.000 Min. :0.02375 ## 1st Qu.:1.58973 1st Qu.:1.229 1st Qu.:1.82281 ## Median :2.23332 Median :2.054 Median :2.35125 ## Mean :1.97772 Mean :1.774 Mean :2.19901 ## 3rd Qu.:2.48288 3rd Qu.:2.351 3rd Qu.:2.77875 ## Max. :3.41475 Max. :3.349 Max. :3.68125 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 153 ## 1st Qu.: 14.75 1st Qu.: 1395 ## Median : 40.00 Median : 3437 ## Mean : 69.28 Mean : 6411 ## 3rd Qu.: 98.75 3rd Qu.: 9812 ## Max. :269.00 Max. :32090 24.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["tc2010-2.html", "24.2 GSEA Round 2", " 24.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 24.2.1 Fit the null model From the Round 1 null analysis (Section 24.1), I found that almost 99.99% posterior mass is concentrated on the setting (h=0.6, theta0=-4.75). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-5:0.025:-4.5)' and h=0.6 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that more than 99.99% posterior mass is concentrated on the settings h=0.6 and theta0=(-4.8:0.025:-4.55)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-4.8,-4.55,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999072 24.2.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=(-4.8:0.025:-4.55)', since the null analysis suggests that more than 99.99% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(4/200):4)', based on the Round 1 enrichment analysis (Section 24.1). The following table lists the GSEA results. gsea.path &lt;- &quot;~/Dropbox/rss/Data/tc_2010/pathway/tc2010_pathway_201609.mat&quot; gsea.df &lt;- gsea.mat2df(gsea.path) source(&quot;src/gsea_dt.R&quot;) gsea.dt -->"],
["mean-cell-haemoglobin-2012.html", "25 Mean Cell Haemoglobin 2012", " 25 Mean Cell Haemoglobin 2012 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The following analyses have been performed on Mean Cell Haemoglobin (MCH) 2012 dataset. GSEA Round 1 (Section 25.1) "],
["mch2012-1.html", "25.1 GSEA Round 1", " 25.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 25.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the setting h=0.6 and theta0=-4. 25.1.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=-4, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(4/200):4)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 25.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.000 Min. :0.000 Min. :0.020 ## 1st Qu.:0.700 1st Qu.:0.700 1st Qu.:0.820 ## Median :1.381 Median :1.380 Median :1.400 ## Mean :1.289 Mean :1.266 Mean :1.315 ## 3rd Qu.:1.720 3rd Qu.:1.705 3rd Qu.:1.720 ## Max. :2.920 Max. :2.900 Max. :2.920 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 271 ## 1st Qu.: 71.25 1st Qu.: 3242 ## Median :106.00 Median : 5268 ## Mean :136.85 Mean : 9128 ## 3rd Qu.:154.75 3rd Qu.:12102 ## Max. :496.00 Max. :50777 25.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["mch2012-2.html", "25.2 GSEA Round 2", " 25.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 25.2.1 Fit the null model From the Round 1 null analysis (Section 25.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.6, theta0=-4). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-4.75:0.05:-3.75)' and h=0.6 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.6 and theta0=(-4.7:0.05:-4.35)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-4.7,-4.35,by=0.05)) sum(null.df$posp.step2[theta0.index]) ## [1] 1 25.2.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=(-4.7:0.05:-4.35)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3/200):3)', based on the Round 1 enrichment analysis (Section 25.1). The following table lists the GSEA results. gsea.path &lt;- &quot;~/Dropbox/rss/Data/mch_2012/pathway/mch2012_pathway_201609.mat&quot; gsea.df &lt;- gsea.mat2df(gsea.path) source(&quot;src/gsea_dt.R&quot;) gsea.dt -->"],
["triglycerides-2010.html", "26 Triglycerides 2010", " 26 Triglycerides 2010 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 21. The following analyses have been performed on Triglycerides (TG) 2010 dataset. GSEA Round 1 (Section 26.1) GSEA Round 2 (Section 26.2) "],
["tg2010-1.html", "26.1 GSEA Round 1", " 26.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 26.1.1 Fit the null model I used the grids theta0=(-6:0.25:-3)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the combinations of h=0.5 and theta0=-6. 26.1.2 Fit the enrichment model To perform GSEA, I set h=0.5 and theta0=-6, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(6/200):6)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 26.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.030 Min. :0.000 Min. :0.060 ## 1st Qu.:2.028 1st Qu.:1.770 1st Qu.:2.377 ## Median :2.921 Median :2.550 Median :3.210 ## Mean :2.775 Mean :2.531 Mean :2.984 ## 3rd Qu.:3.752 3rd Qu.:3.630 3rd Qu.:3.877 ## Max. :4.679 Max. :4.650 Max. :4.680 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 189 ## 1st Qu.: 17.00 1st Qu.: 1271 ## Median : 41.00 Median : 3524 ## Mean : 73.69 Mean : 6182 ## 3rd Qu.: 95.75 3rd Qu.: 7958 ## Max. :496.00 Max. :46258 26.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["tg2010-2.html", "26.2 GSEA Round 2", " 26.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 26.2.1 Fit the null model From the Round 1 null analysis (Section 26.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.5, theta0=-6). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-6.25:0.025:-5.75)' and h=0.5 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.5 and theta0=(-6.25:0.025:-6.1)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-6.25,-6.1,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999997 26.2.2 Fit the enrichment model To perform GSEA, I set h=0.5 and theta0=(-6.25:0.025:-6.1)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta=(0:(5.2/260):5.2)', based on the Round 1 enrichment analysis (Section 26.1). The following table lists the GSEA results. gsea.path &lt;- &quot;~/Dropbox/rss/Data/tg_2010/pathway/tg2010_pathway_201609.mat&quot; gsea.df &lt;- gsea.mat2df(gsea.path) source(&quot;src/gsea_dt.R&quot;) gsea.dt -->"],
["mean-cell-volume-2012.html", "27 Mean Cell Volume 2012", " 27 Mean Cell Volume 2012 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The following analyses have been performed on Mean Cell Volume (MCV) 2012 dataset. GSEA Round 1 (Section 27.1) GSEA Round 2 (Section 27.2) "],
["mcv2012-1.html", "27.1 GSEA Round 1", " 27.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 27.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the setting h=0.6 and theta0=-4. 27.1.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=-4, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(4/200):4)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 27.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.3267 Min. :0.060 Min. :0.380 ## 1st Qu.:1.0800 1st Qu.:1.060 1st Qu.:1.095 ## Median :1.5000 Median :1.500 Median :1.520 ## Mean :1.4342 Mean :1.419 Mean :1.453 ## 3rd Qu.:1.8650 3rd Qu.:1.845 3rd Qu.:1.865 ## Max. :2.6400 Max. :2.640 Max. :2.640 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 8.00 Min. : 741 ## 1st Qu.: 72.75 1st Qu.: 3505 ## Median :105.00 Median : 5528 ## Mean :142.33 Mean : 9684 ## 3rd Qu.:178.50 3rd Qu.:13130 ## Max. :496.00 Max. :50844 27.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["mcv2012-2.html", "27.2 GSEA Round 2", " 27.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 27.2.1 Fit the null model From the Round 1 null analysis (Section 27.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.6, theta0=-4). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-4.25:0.025:-3.75)' and h=0.6 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.6 and theta0=(-4.225:0.025:-4.125)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-4.225,-4.125,by=0.025)) sum(null.df$posp.step1[theta0.index]) ## [1] 1 sum(null.df$posp.step2[theta0.index]) ## [1] 1 27.2.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=(-4.225:0.025:-4.125)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3/150):3)'. The following table lists the GSEA results. gsea.path &lt;- &quot;~/Dropbox/rss/Data/mcv_2012/pathway/mcv2012_pathway_201609.mat&quot; gsea.df &lt;- gsea.mat2df(gsea.path) source(&quot;src/gsea_dt.R&quot;) gsea.dt -->"],
["fg2012.html", "28 Fasting Glucose 2012", " 28 Fasting Glucose 2012 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Manning et al. (2012) are provided by the Meta-Analyses of Glucose and Insulin-related traits Consortium (MAGIC). The basic information about these datasets is available here. The following analyses have been performed on BMI-adjusted Fasting Glucose (FGadjBMI) 2012 dataset. GSEA Round 1 (Section 28.1) GSEA Round 2 (Section 28.2) References "],
["fg2012-1.html", "28.1 GSEA Round 1", " 28.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 28.1.1 Fit the null model I used the grids theta0=(-6:0.25:-3)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the setting h=0.6 and theta0=-5.25. 28.1.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=-5.25, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(5.25/200):5.25)'. The following table lists the GSEA results. 28.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["fg2012-2.html", "28.2 GSEA Round 2", " 28.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 28.2.1 Fit the null model From the Round 1 null analysis (Section 28.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.6, theta0=-5.25). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-6:0.05:-5)' and h=0.6 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.6 and theta0=(-6:0.05:-5.75)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-6,-5.75,by=0.05)) sum(null.df$posp.step2[theta0.index]) ## [1] 1 28.2.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=-5.25, since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(5.25/200):5.25)'. The following table lists the GSEA results. gsea.path &lt;- &quot;~/Dropbox/rss/Data/fg_2012/pathway/fg2012_pathway_201604.mat&quot; gsea.df &lt;- gsea.mat2df(gsea.path) source(&quot;src/gsea_dt.R&quot;) gsea.dt -->"],
["fasting-insulin-2012.html", "29 Fasting Insulin 2012", " 29 Fasting Insulin 2012 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 28. The following analyses have been performed on BMI-adjusted Fasting Insulin (FIadjBMI) 2012 dataset. GSEA Round 1 (Section 29.1) GSEA Round 2 (Section 29.2) "],
["lfi2012-1.html", "29.1 GSEA Round 1", " 29.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 29.1.1 Fit the null model I used the grids theta0=(-6:0.25:-3)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.5% posterior mass is concentrated on the setting h=0.6 and theta0=-6. 29.1.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=-6, since the null analysis suggests that almost 99.5% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(6/200):6)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 29.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.150 Min. :0.150 Min. :0.150 ## 1st Qu.:1.326 1st Qu.:1.050 1st Qu.:1.567 ## Median :1.578 Median :1.410 Median :1.800 ## Mean :1.657 Mean :1.477 Mean :1.823 ## 3rd Qu.:1.867 3rd Qu.:1.710 3rd Qu.:2.130 ## Max. :3.480 Max. :3.480 Max. :3.510 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 3.00 Min. : 254 ## 1st Qu.: 32.75 1st Qu.: 3034 ## Median : 64.00 Median : 6614 ## Mean : 70.45 Mean : 7235 ## 3rd Qu.: 98.00 3rd Qu.: 9660 ## Max. :220.00 Max. :25686 29.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["lfi2012-2.html", "29.2 GSEA Round 2", " 29.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 29.2.1 Fit the null model From the Round 1 null analysis (Section 29.1), I found that almost 99.5% posterior mass is concentrated on the setting (h=0.6, theta0=-6). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-6.25:0.025:-5.75)' and h=0.6 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.99% posterior mass is concentrated on the settings h=0.6 and theta0=(-6.25:0.025:-6)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-6.25,-6,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999517 29.2.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=(-6.25:0.025:-6)', since the null analysis suggests that almost 99.99% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(3.8/200):3.8)', based on the Round 1 enrichment analysis (Section 29.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["mean-cell-haemoglobin-concentration-2012.html", "30 Mean Cell Haemoglobin Concentration 2012", " 30 Mean Cell Haemoglobin Concentration 2012 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The following analyses have been performed on Mean Cell Haemoglobin Concentration (MCHC) 2012 dataset. GSEA Round 1 (Section 30.1) GSEA Round 2 (Section 30.2) "],
["mchc2012-1.html", "30.1 GSEA Round 1", " 30.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 30.1.1 Fit the null model I used the grids theta0=(-6:0.25:-3)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 98.8% posterior mass is concentrated on the settings h=[0.3 0.4 0.5 0.6] and theta0 = (-6:0.25:-5.25). theta0.index &lt;- null.df$theta0 %in% seq(-6,-5.25,by=0.25) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9877869 30.1.2 Fit the enrichment model To perform GSEA, I set h=[0.3 0.4 0.5 0.6] and theta0 = (-6:0.25:-5.25), since the null analysis suggests that almost 98.8% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(6/12):6)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 30.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.09225 Min. :0.00 Min. :0.50 ## 1st Qu.:2.00103 1st Qu.:1.50 1st Qu.:2.50 ## Median :2.50000 Median :2.50 Median :2.75 ## Mean :2.60113 Mean :2.31 Mean :2.84 ## 3rd Qu.:3.00000 3rd Qu.:3.00 3rd Qu.:3.50 ## Max. :4.50000 Max. :4.00 Max. :4.50 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 97.0 ## 1st Qu.: 7.75 1st Qu.: 725.8 ## Median :15.00 Median :1187.0 ## Mean :19.72 Mean :1618.5 ## 3rd Qu.:27.00 3rd Qu.:2093.5 ## Max. :68.00 Max. :6889.0 30.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["mchc2012-2.html", "30.2 GSEA Round 2", " 30.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 30.2.1 Fit the null model From the Round 1 null analysis (Section 30.1), I found that almost 98.8% of the posterior mass is concentrated on the settings h=(0.3:0.1:0.6)' and theta0 = (-6:0.25:-5.25). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-6:0.05:-5)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 84 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that the posterior mass is almost uniformly concentrated on the settings h=(0.3:0.1:0.6)' and theta0 = (-6:0.05:-5). theta0.index &lt;- null.df$theta0 %in% seq(-6,-5.25,by=0.25) sum(null.df$posp.step2[theta0.index]) ## [1] 0.2321329 30.2.2 Fit the enrichment model To perform GSEA, I set h=(0.3:0.1:0.6)' and theta0 = (-6:0.05:-5), since the null analysis suggests that the posterior mass is uniformly placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(5/50):5)', based on the Round 1 enrichment analysis (Section 30.1). The following table lists the GSEA results. gsea.path &lt;- &quot;~/Dropbox/rss/Data/mchc_2012/pathway/mchc2012_pathway_201609.mat&quot; gsea.df &lt;- gsea.mat2df(gsea.path) source(&quot;src/gsea_dt.R&quot;) gsea.dt -->"],
["gout-2013.html", "31 Gout 2013", " 31 Gout 2013 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 For the basic information about the data used here, please see Section 20. The following analyses have been performed on Gout 2013 dataset. GSEA Round 1 (Section 31.1) GSEA Round 2 (Section 31.2) "],
["gout2013-1.html", "31.1 GSEA Round 1", " 31.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 31.1.1 Fit the null model I used the grids theta0=(-5.5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.9% posterior mass is concentrated on the combinations of h=[0.3 0.4 0.5 0.6] and theta0 = (-5.5:0.25:-4.75). theta0.index &lt;- null.df$theta0 %in% seq(-5.5,-4.75,by=0.25) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9993001 31.1.2 Fit the enrichment model To perform GSEA, I set h=[0.3 0.4 0.5 0.6] and theta0 = (-5.5:0.25:-4.75), since the null analysis suggests that almost 99.9% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(5.5/12):5.5)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 31.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.8086 Min. :0.0000 Min. :1.375 ## 1st Qu.:1.4292 1st Qu.:0.4583 1st Qu.:1.833 ## Median :2.0871 Median :0.9167 Median :2.750 ## Mean :2.0989 Mean :1.3108 Mean :2.649 ## 3rd Qu.:2.6288 3rd Qu.:1.8333 3rd Qu.:3.208 ## Max. :4.5831 Max. :4.1250 Max. :4.583 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 61.0 ## 1st Qu.: 8.00 1st Qu.: 707.2 ## Median : 17.50 Median : 1379.5 ## Mean : 39.04 Mean : 3516.1 ## 3rd Qu.: 53.25 3rd Qu.: 5004.2 ## Max. :254.00 Max. :25015.0 31.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["gout2013-2.html", "31.2 GSEA Round 2", " 31.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 31.2.1 Fit the null model From the Round 1 null analysis (Section 31.1), I found that almost 99.9% posterior mass is concentrated on the settings h=(0.3:0.1:0.6)' and theta0=(-5.5:0.25:-4.75). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-5.5:0.05:-4.5)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 84 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.9% posterior mass is concentrated on the settings of h=(0.3:0.1:0.6)' and theta0 = (-5.5:0.05:-4.6). theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-5.5,-4.6,by=0.05)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9994462 31.2.2 Fit the enrichment model To perform GSEA, I set h=(0.3:0.1:0.6)' and theta0 = (-5.5:0.05:-4.6), since the null analysis suggests that almost 99.9% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(5/50):5)', based on the Round 1 enrichment analysis (Section 31.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["haemoglobin-2012.html", "32 Haemoglobin 2012", " 32 Haemoglobin 2012 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The following analyses have been performed on Haemoglobin (Hb) 2012 dataset. GSEA Round 1 (Section 32.1) GSEA Round 2 (Section 32.2) "],
["hb2012-1.html", "32.1 GSEA Round 1", " 32.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 32.1.1 Fit the null model I used the grids theta0=(-6:0.25:-3)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.9% posterior mass is concentrated on the setting h=0.6 and theta0=-6. 32.1.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=-6, since the null analysis suggests that almost 99.9% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta = (0:(6/200):6)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 32.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.660 Min. :0.630 Min. :0.660 ## 1st Qu.:2.183 1st Qu.:2.183 1st Qu.:2.205 ## Median :2.711 Median :2.700 Median :2.715 ## Mean :2.600 Mean :2.589 Mean :2.611 ## 3rd Qu.:3.039 3rd Qu.:3.030 3rd Qu.:3.075 ## Max. :3.990 Max. :3.960 Max. :3.990 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 8.00 Min. : 743 ## 1st Qu.: 68.75 1st Qu.: 3310 ## Median :103.00 Median : 4992 ## Mean :134.16 Mean : 8749 ## 3rd Qu.:170.00 3rd Qu.:12126 ## Max. :490.00 Max. :50451 32.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["hb2012-2.html", "32.2 GSEA Round 2", " 32.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 32.2.1 Fit the null model From the Round 1 null analysis (Section 32.1), I found that almost 100% posterior mass is concentrated on the setting h=0.6 and theta0=-6. In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-6.25:0.025:-5.75)' and h=0.6 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.6 and theta0=(-6.25:0.025:-5.9)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-6.25,-5.9,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999994 32.2.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=(-6.25:0.025:-5.9)', since the null analysis suggests that almost 100% posterior mass is placed on these settings. For the log-fold enrichment parameter, I use the grid theta = (0:(4/200):4)', based on the Round 1 enrichment analysis (Section 32.1). The following table lists the GSEA results. gsea.path &lt;- &quot;~/Dropbox/rss/Data/hb_2012/pathway/hb2012_pathway_201609.mat&quot; gsea.df &lt;- gsea.mat2df(gsea.path) source(&quot;src/gsea_dt.R&quot;) gsea.dt -->"],
["packed-cell-volume-2012.html", "33 Packed Cell Volume 2012", " 33 Packed Cell Volume 2012 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The following analyses have been performed on Packed Cell Volume (PCV) 2012 dataset. GSEA Round 1 (Section 33.1) GSEA Round 2 (Section 33.2) "],
["pcv2012-1.html", "33.1 GSEA Round 1", " 33.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 33.1.1 Fit the null model I used the grids theta0=(-5:0.25:-2)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 52 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the setting h=0.6 and theta0=-5. 33.1.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=-5, since the null analysis suggests that almost 100% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta = (0:(5/200):5)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 33.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :0.7137 Min. :0.300 Min. :0.950 ## 1st Qu.:1.3538 1st Qu.:1.062 1st Qu.:1.575 ## Median :1.9190 Median :1.825 Median :1.962 ## Mean :1.9315 Mean :1.798 Mean :2.063 ## 3rd Qu.:2.3129 3rd Qu.:2.312 3rd Qu.:2.425 ## Max. :3.8750 Max. :3.875 Max. :3.900 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 257 ## 1st Qu.: 14.50 1st Qu.: 1387 ## Median : 37.00 Median : 3076 ## Mean : 44.19 Mean : 3338 ## 3rd Qu.: 64.00 3rd Qu.: 4470 ## Max. :234.00 Max. :11893 33.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["pcv2012-2.html", "33.2 GSEA Round 2", " 33.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 33.2.1 Fit the null model From the Round 1 null analysis (Section 33.1), I found that almost 100% posterior mass is concentrated on the setting (h=0.6, theta0=-5). In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-5.25:0.025:-4.75)' and h=0.6 when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 21 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 100% posterior mass is concentrated on the settings h=0.6 and theta0=(-5.25:0.025:-5.15)'. theta0.index &lt;- as.character(null.df$theta0) %in% as.character(seq(-5.25,-5.15,by=0.025)) sum(null.df$posp.step2[theta0.index]) ## [1] 1 33.2.2 Fit the enrichment model To perform GSEA, I set h=0.6 and theta0=(-5.25:0.025:-5.15)', since the null analysis suggests that almost 100% posterior mass is placed on this setting. For the log-fold enrichment parameter, I use the grid theta = (0:(4.5/225):4.5)'. The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["amyotrophic-lateral-sclerosis-2016.html", "34 Amyotrophic Lateral Sclerosis 2016", " 34 Amyotrophic Lateral Sclerosis 2016 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 The GWAS summary statistics corresponding to Rheenen et al. (2016) are provided by the Project MinE. The data-sharing policy of Project MinE data is available here. The following analyses have been performed on Amyotrophic Lateral Sclerosis (ALS) 2016 dataset. GSEA Round 1 (Section 34.1) GSEA Round 2 (Section 34.2) References "],
["als2016-1.html", "34.1 GSEA Round 1", " 34.1 GSEA Round 1 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 34.1.1 Fit the null model I used the grids theta0=(-6:0.25:-3)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 68 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that almost 99.99% posterior mass is concentrated on the settings h=[0.3 0.4 0.5 0.6] and theta0 = (-6:0.25:-5)'. theta0.index &lt;- null.df$theta0 %in% seq(-6,-5,by=0.25) sum(null.df$posp.step2[theta0.index]) ## [1] 0.9999068 34.1.2 Fit the enrichment model To perform GSEA, I use a smaller grid that includes h=[0.3 0.4 0.5 0.6] and theta0 = (-6:0.25:-5)', since the null analysis suggests that almost 99.99% posterior mass is placed on thses settings. For the log-fold enrichment parameter, I use the grid theta=(0:(6/10):6)'. The following table lists the GSEA results. To help decide the grid for theta in Round 2 enrichment analysis (Section 34.2), I visualized the posterior mean, 95% lower and upper bound of theta for the top 100 enriched pathways identified in Round 1 analysis. gsea.df.sorted &lt;- plyr::arrange(gsea.df, -log10.bf) gsea.df.top100 &lt;- gsea.df.sorted[1:100, ] summary(gsea.df.top100[, c(&quot;theta.mean&quot;,&quot;theta.95lb&quot;,&quot;theta.95ub&quot;)]) ## theta.mean theta.95lb theta.95ub ## Min. :1.093 Min. :0.000 Min. :1.800 ## 1st Qu.:1.512 1st Qu.:0.000 1st Qu.:2.400 ## Median :1.584 Median :0.000 Median :3.000 ## Mean :1.631 Mean :0.108 Mean :3.012 ## 3rd Qu.:1.695 3rd Qu.:0.000 3rd Qu.:3.600 ## Max. :2.685 Max. :1.200 Max. :3.600 summary(gsea.df.top100[, c(&quot;numgene&quot;,&quot;numsnps&quot;)]) ## numgene numsnps ## Min. : 2.00 Min. : 67.0 ## 1st Qu.: 2.00 1st Qu.: 137.8 ## Median : 18.50 Median : 1661.5 ## Mean : 38.94 Mean : 4241.9 ## 3rd Qu.: 60.25 3rd Qu.: 7165.5 ## Max. :259.00 Max. :31471.0 34.1.3 Enrichment analysis in GTEx I also ran the GSEA using the clustering results of GTEx gene expression V6 data (20 clusters, each with 100 genes). "],
["als2016-2.html", "34.2 GSEA Round 2", " 34.2 GSEA Round 2 Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 34.2.1 Fit the null model From the Round 1 null analysis (Section 34.1), I found that almost 99.99% posterior mass is concentrated on the settings h=(0.3:0.1:0.6)' and theta0 = (-6:0.25:-5)'. In Round 2, I used a finer grid. Specifically, I used the grids theta0=(-6:0.05:-5)' and h=(0.3:0.1:0.6)' when fitting the null model. I estimated the (unnormalized) log importance weights (“pseudo-likelihoods”) for all 84 sets of (h,theta0) under null. After normalizing the log “pseudo-likelihoods” (logw.step*) to posterior probabilities (posp.step*), we can see that the posterior mass is almost uniformly scattered on the settings h=(0.3:0.1:0.6)' and theta0 = (-6:0.05:-5)'. 34.2.2 Fit the enrichment model To perform GSEA, I use a smaller grid that includes h=(0.3:0.1:0.6)' and theta0=(-6:0.05:-5)', since the null analysis suggests that almost 99.99% posterior mass is placed on thses settings. For the log-fold enrichment parameter, I use the grid theta=(0:(4/40):4)', based on the Round 1 enrichment analysis (Section 34.1). The following table lists the GSEA results. Now we compare the enrichment Bayes factors from Round 1 and 2 analyses. -->"],
["acknowledgement.html", "35 Acknowledgement", " 35 Acknowledgement Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 Genetic Investigation of ANthropometric Traits (GIANT) Consortium Data on adult human height, body mass index and body fat distribution have been contributed by GIANT investigators and have been downloaded from portals.broadinstitute.org/collaboration/giant/. Psychiatric Genomics Consortium (PGC) Data on schizophrenia have been contributed by PGC investigators and have been downloaded from www.med.unc.edu/pgc/. International Inflammatory Bowel Disease Genetics Consortium (IIBDGC) Data on inflammatory bowel disease, Crohn’s disease and ulcerative colitis have been contributed by IIBDGC investigators and have been downloaded from www.ibdgenetics.org. Coronary ARtery DIsease Genome wide Replication and Meta-analysis (CARDIoGRAM) plus The Coronary Artery Disease (C4D) Genetics (CARDIoGRAMplusC4D) Consortium Data on coronary artery disease and myocardial infarction have been contributed by CARDIoGRAMplusC4D investigators and have been downloaded from www.cardiogramplusc4d.org. International Genomics of Alzheimer’s Project (IGAP) We thank the International Genomics of Alzheimer’s Project (IGAP) for providing summary results data for these analyses. The investigators within IGAP contributed to the design and implementation of IGAP and/or provided data but did not participate in analysis or writing of this report. IGAP was made possible by the generous participation of the control subjects, the patients, and their families. The i–Select chips was funded by the French National Foundation on Alzheimer’s disease and related disorders. EADI was supported by the LABEX (laboratory of excellence program investment for the future) DISTALZ grant, Inserm, Institut Pasteur de Lille, Université de Lille 2 and the Lille University Hospital. GERAD was supported by the Medical Research Council (Grant no. 503480), Alzheimer’s Research UK (Grant no. 503176), the Wellcome Trust (Grant no. 082604/2/07/Z) and German Federal Ministry of Education and Research (BMBF): Competence Network Dementia (CND) grant no. 01GI0102, 01GI0711, 01GI0420. CHARGE was partly supported by the NIH/NIA grant R01 AG033193 and the NIA AG081220 and AGES contract N01–AG–12100, the NHLBI grant R01 HL105756, the Icelandic Heart Association, and the Erasmus Medical Center and Erasmus University. ADGC was supported by the NIH/NIA grants: U01 AG032984, U24 AG021886, U01 AG016976, and the Alzheimer’s Association grant ADGC–10–196728. Social Science Genetic Association Consortium (SSGAC) Data on neuroticism and depressive symptoms have been contributed by SSGAC investigators and have been downloaded from www.thessgac.org. Eurpean GWAS meta-analysis summary statistics from Okada et al. (Nature, 2014) Data on rheumatoid arthritis have been contributed by authors of Okada et al. (Nature, 2014) and have been downloaded from http://plaza.umin.ac.jp/yokada/datasource/software.htm. DIAbetes Genetics Replication And Meta-analysis (DIAGRAM) consortium Data on type 2 diabetes have been contributed by DIAGRAM investigators and have been downloaded from www.diagram-consortium.org. Reproductive Genetics (ReproGen) Consortium Data on age at natural menopause have been contributed by ReproGen investigators and have been downloaded from http://www.reprogen.org. Global Urate Genetics Consortium (GUGC) Data on serum urate concentrations and gout have been contributed by GUGC investigators and have been downloaded from http://metabolomics.helmholtz-muenchen.de/gugc/. Global Lipids Genetics Consortium (GLGC) Data on total cholesterol, low-density lipoprotein cholesterol, high-density lipoprotein cholesterol and triglycerides have been contributed by GLGC investigators and have been downloaded from http://csg.sph.umich.edu//abecasis/public/lipids2010/. Meta-Analyses of Glucose and Insulin-related traits Consortium (MAGIC) Data on glycaemic traits have been contributed by MAGIC investigators and have been downloaded from www.magicinvestigators.org. Project MinE Data on amyotrophic lateral sclerosis have been contributed by Project MinE investigators and have been downloaded from databrowser.projectmine.com. "],
["add-a-new-chapter.html", "36 Add a new chapter", " 36 Add a new chapter Last updated: 2016-11-13 Code version: 98ddb9c8b15b60e7280bc039fabdcaa702a3ea77 This is a template for writing reports with R Markdown. "],
["section-title.html", "36.1 Section title", " 36.1 Section title You can create a new file from the template using the command cp. "],
["session-information.html", "36.2 Session information", " 36.2 Session information sessionInfo() ## R version 3.3.2 (2016-10-31) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 14.04.5 LTS ## ## locale: ## [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C ## [3] LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8 ## [5] LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8 ## [7] LC_PAPER=en_US.UTF-8 LC_NAME=C ## [9] LC_ADDRESS=C LC_TELEPHONE=C ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C ## ## attached base packages: ## [1] stats4 parallel stats graphics grDevices utils datasets ## [8] methods base ## ## other attached packages: ## [1] Matrix_1.2-7.1 ## [2] org.Hs.eg.db_3.3.0 ## [3] bumphunter_1.12.0 ## [4] locfit_1.5-9.1 ## [5] iterators_1.0.8 ## [6] foreach_1.4.3 ## [7] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2 ## [8] GenomicFeatures_1.24.2 ## [9] AnnotationDbi_1.34.3 ## [10] Biobase_2.32.0 ## [11] GenomicRanges_1.24.0 ## [12] GenomeInfoDb_1.8.1 ## [13] IRanges_2.6.0 ## [14] S4Vectors_0.10.1 ## [15] BiocGenerics_0.18.0 ## [16] reshape2_1.4.1 ## [17] plotly_3.6.0 ## [18] UpSetR_1.2.0 ## [19] plyr_1.8.3 ## [20] knitr_1.13 ## [21] ggplot2_2.1.0 ## [22] DT_0.1 ## [23] R.matlab_3.5.1 ## ## loaded via a namespace (and not attached): ## [1] viridis_0.3.4 httr_1.1.0 ## [3] tidyr_0.6.0 jsonlite_0.9.19 ## [5] R.utils_2.3.0 shiny_0.13.2 ## [7] assertthat_0.1 highr_0.6 ## [9] doRNG_1.6 Rsamtools_1.24.0 ## [11] yaml_2.1.13 RSQLite_1.0.0 ## [13] lattice_0.20-34 digest_0.6.9 ## [15] RColorBrewer_1.1-2 XVector_0.12.0 ## [17] colorspace_1.2-6 htmltools_0.3.5 ## [19] httpuv_1.3.3 R.oo_1.20.0 ## [21] XML_3.98-1.4 biomaRt_2.28.0 ## [23] bookdown_0.0.71 zlibbioc_1.18.0 ## [25] xtable_1.8-2 scales_0.4.0 ## [27] BiocParallel_1.6.2 tibble_1.2 ## [29] pkgmaker_0.22 SummarizedExperiment_1.2.2 ## [31] magrittr_1.5 mime_0.4 ## [33] evaluate_0.9 R.methodsS3_1.7.1 ## [35] tools_3.3.2 registry_0.3 ## [37] matrixStats_0.50.2 formatR_1.4 ## [39] stringr_1.0.0 munsell_0.4.3 ## [41] rngtools_1.2.4 Biostrings_2.40.1 ## [43] grid_3.3.2 RCurl_1.95-4.8 ## [45] htmlwidgets_0.6 miniUI_0.1.1 ## [47] bitops_1.0-6 base64enc_0.1-3 ## [49] labeling_0.3 rmarkdown_0.9.6 ## [51] gtable_0.2.0 codetools_0.2-15 ## [53] DBI_0.4-1 R6_2.1.2 ## [55] GenomicAlignments_1.8.0 gridExtra_2.2.1 ## [57] rtracklayer_1.32.0 stringi_1.0-1 ## [59] Rcpp_0.12.7 -->"],
["references.html", "References", " References "]
]
